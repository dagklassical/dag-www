---
// LayoutArtistaNFT - Versión Centralizada CSS
// Archivo: src/layouts/LayoutArtistaNFT-Centralizado.astro
// Propósito: Layout para artistas usando nueva arquitectura CSS centralizada
// Importa estilos específicos de artistas desde src/styles/components/artistas.css

import '../styles/components/artistas.css';

// Importar Layout Base (con CSS global)
import LayoutBase from './Layout.astro';

// Props del Layout
interface DigitalIdVerified {
  status: 'verified';
  id: string;
  chain: string;
  tokenId: string;
  mintedDate: string;
  blockchainUrl: string;
  metadata: {
    nationality: string;
    genre: string;
    instruments: string[];
    education: string;
    verifiedBy: string;
  };
}

interface DigitalIdPending {
  status: 'pending';
  reason: string;
  estimatedDate?: string;
  processInfo?: string;
}

interface CollectionNFT {
  id: string;
  title: string;
  type: string;
  description: string;
  available: boolean;
  totalEditions: number;
  remainingEditions: number;
  price: string;
  image: string;
}

interface SocialLinks {
  spotify?: string;
  instagram?: string;
  youtube?: string;
  twitter?: string;
  facebook?: string;
  tiktok?: string;
}

interface Props {
  title: string;
  artistName: string;
  artistImage: string;
  digitalId: DigitalIdVerified | DigitalIdPending;
  biography: string;
  collections: CollectionNFT[];
  socialLinks: SocialLinks;
  nftStats?: {
    totalCollections: number;
    totalEditions: number;
    soldEditions: number;
    totalRevenue: string;
  };
  subpages?: Array<{
    title: string;
    url: string;
    description: string;
  }>;
}

const { 
  title,
  artistName,
  artistImage,
  digitalId,
  biography,
  collections = [],
  socialLinks = {},
  nftStats = {
    totalCollections: 0,
    totalEditions: 0,
    soldEditions: 0,
    totalRevenue: '0 ETH'
  },
  subpages = []
} = Astro.props;

// Meta tags SEO específicos del artista
const artistDescription = `Descubre a ${artistName}, artista con Digital ID ${digitalId.status === 'verified' ? 'verificado' : 'pendiente'} en DAG Klassical. ${digitalId.status === 'verified' ? 'Colecciones NFT disponibles' : 'Próximas colecciones'}.`;
const artistImageUrl = artistImage.startsWith('http') ? artistImage : `${import.meta.env.BASE_URL}${artistImage}`;
---

<LayoutBase 
  title={title}
  description={artistDescription}
  image={artistImage}
  type="profile"
>
  <div class="artist-page">
    
    <!-- Hero Section -->
    <section class="hero-section">
      <div class="container">
        <div class="hero-content">
          <div class="artist-image-container">
            <img src={artistImageUrl} alt={artistName} class="artist-image" />
            <div class={`digital-id-badge ${digitalId.status}`}>
              {digitalId.status === 'verified' ? '✓' : '⏳'} 
              Digital ID {digitalId.status === 'verified' ? 'Verificado' : 'Pendiente'}
            </div>
          </div>
          
          <div class="artist-info">
            <h1 class="artist-name text-gradient">{artistName}</h1>
            
            <!-- Digital ID Info -->
            {digitalId.status === 'verified' && (
              <div class="digital-id-info">
                <div class="info-item">
                  <span class="label">ID:</span>
                  <span class="value">{digitalId.id}</span>
                </div>
                <div class="info-item">
                  <span class="label">Blockchain:</span>
                  <span class="value">{digitalId.chain}</span>
                </div>
                <div class="info-item">
                  <span class="label">Mint Date:</span>
                  <span class="value">{digitalId.mintedDate}</span>
                </div>
              </div>
            )}
            
            {digitalId.status === 'pending' && (
              <div class="pending-info">
                <p class="pending-reason">{digitalId.reason}</p>
                {digitalId.estimatedDate && (
                  <p class="estimated-date">
                    <strong>Fecha estimada:</strong> {digitalId.estimatedDate}
                  </p>
                )}
                {digitalId.processInfo && (
                  <p class="process-info">{digitalId.processInfo}</p>
                )}
              </div>
            )}
            
            <!-- Social Links -->
            {Object.keys(socialLinks).length > 0 && (
              <div class="social-section">
                <h3>Sígueme en</h3>
                <div class="social-links">
                  {socialLinks.spotify && (
                    <a href={socialLinks.spotify} target="_blank" rel="noopener noreferrer" class="social-link spotify">
                      <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                        <path d="M12 0C5.4 0 0 5.4 0 12s5.4 12 12 12 12-5.4 12-12S18.66 0 12 0zm5.521 17.34c-.24.359-.66.48-1.021.24-2.82-1.74-6.36-2.101-10.561-1.141-.418.122-.779-.179-.899-.539-.12-.421.18-.78.54-.9 4.56-1.021 8.52-.6 11.64 1.32.42.18.479.659.301 1.02zm1.44-3.3c-.301.42-.841.6-1.262.3-3.239-1.98-8.159-2.58-11.939-1.38-.479.12-1.02-.12-1.14-.6-.12-.48.12-1.021.6-1.141C9.6 9.9 15 10.561 18.72 12.84c.361.181.54.78.241 1.2zm.12-3.36C15.24 8.4 8.82 8.16 5.16 9.301c-.6.179-1.2-.181-1.38-.721-.18-.601.18-1.2.72-1.381 4.26-1.26 11.28-1.02 15.721 1.621.539.3.719 1.02.42 1.56-.299.421-1.02.599-1.559.3z"/>
                      </svg>
                      Spotify
                    </a>
                  )}
                  
                  {socialLinks.instagram && (
                    <a href={socialLinks.instagram} target="_blank" rel="noopener noreferrer" class="social-link instagram">
                      <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                        <rect x="2" y="2" width="20" height="20" rx="5" ry="5"></rect>
                        <path d="M16 11.37A4 4 0 1 1 12.63 8 4 4 0 0 1 16 11.37z"></path>
                        <line x1="17.5" y1="6.5" x2="17.51" y2="6.5"></line>
                      </svg>
                      Instagram
                    </a>
                  )}
                  
                  {socialLinks.youtube && (
                    <a href={socialLinks.youtube} target="_blank" rel="noopener noreferrer" class="social-link youtube">
                      <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                        <path d="M22.54 6.42a2.78 2.78 0 0 0-1.94-2C18.88 4 12 4 12 4s-6.88 0-8.6.46a2.78 2.78 0 0 0-1.94 2A29 29 0 0 0 1 11.75a29 29 0 0 0 .46 5.33A2.78 2.78 0 0 0 3.4 19c1.72.46 8.6.46 8.6.46s6.88 0 8.6-.46a2.78 2.78 0 0 0 1.94-2 29 29 0 0 0 .46-5.25 29 29 0 0 0-.46-5.33z"></path>
                        <polygon points="9.75 15.02 15.5 11.75 9.75 8.48 9.75 15.02"></polygon>
                      </svg>
                      YouTube
                    </a>
                  )}
                  
                  {socialLinks.twitter && (
                    <a href={socialLinks.twitter} target="_blank" rel="noopener noreferrer" class="social-link twitter">
                      <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                        <path d="M23 3a10.9 10.9 0 0 1-3.14 1.53 4.48 4.48 0 0 0-7.86 3v1A10.66 10.66 0 0 1 3 4s-4 9 5 13a11.64 11.64 0 0 1-7 2c9 5 20 0 20-11.5a4.5 4.5 0 0 0-.08-.83A7.72 7.72 0 0 0 23 3z"></path>
                      </svg>
                      Twitter
                    </a>
                  )}
                </div>
              </div>
            )}
          </div>
        </div>
      </div>
    </section>

    <!-- Biography Section usando estilos centralizados -->
    <section class="biography-section">
      <div class="container">
        <div class="biography-content" set:html={biography} />
      </div>
    </section>

    <!-- Collections Section -->
    {collections.length > 0 && (
      <section class="collections-section">
        <div class="container">
          <h2 class="section-title text-center">Colecciones NFT</h2>
          <div class="album-grid"> {/* Usando grid centralizado */}
            {collections.map(collection => (
              <div class={`collection-card ${!collection.available ? 'unavailable' : ''}`}>
                <div class="collection-image">
                  <img src={`${import.meta.env.BASE_URL}${collection.image}`} alt={collection.title} />
                  {!collection.available && (
                    <div class="unavailable-overlay">
                      <span>Próximamente</span>
                    </div>
                  )}
                </div>
                
                <div class="collection-info">
                  <div class="collection-header">
                    <h3 class="collection-title">{collection.title}</h3>
                    <span class="collection-type badge badge-primary">{collection.type}</span>
                  </div>
                  
                  <p class="collection-description">{collection.description}</p>
                  
                  <div class="collection-details">
                    <div class="edition-info">
                      <span class="remaining">{collection.remainingEditions}</span>
                      <span class="total">de {collection.totalEditions}</span>
                      <span class="label">disponibles</span>
                    </div>
                    
                    <div class="collection-price">
                      <span class="price">{collection.price}</span>
                    </div>
                  </div>
                  
                  {collection.available ? (
                    <button class="btn btn-primary acquire-btn">
                      Adquirir NFT
                    </button>
                  ) : (
                    <button class="btn btn-secondary" disabled>
                      Próximamente
                    </button>
                  )}
                </div>
              </div>
            ))}
          </div>
        </div>
      </section>
    )}

    <!-- CTA Section: "ESTE PUEDE SER TU LUGAR" usando estilos centralizados -->
    <section class="cta-section">
      <div class="container">
        <div class="cta-card artist-cta-placeholder">
          <div class="cta-placeholder-content">
            <div class="cta-icon">
              <svg width="64" height="64" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                <circle cx="12" cy="12" r="10" stroke-width="2"/>
                <line x1="12" y1="8" x2="12" y2="12" stroke-width="2"/>
                <line x1="12" y1="16" x2="12.01" y2="16" stroke-width="2"/>
              </svg>
            </div>
            <h3 class="text-gradient">Este Puede Ser Tu Lugar en DAG Klassical</h3>
            <p class="text-muted">Únete a nuestra familia de artistas verificados con Digital ID en blockchain</p>
            <a href="/contacto" class="btn btn-primary">Postular como Artista</a>
          </div>
        </div>
      </div>
    </section>

    <!-- NFT Stats (solo para verificados) -->
    {digitalId.status === 'verified' && (
      <section class="stats-section">
        <div class="container">
          <h2 class="section-title text-center">Estadísticas NFT</h2>
          <div class="stats-grid">
            <div class="stat-card">
              <div class="stat-value">{nftStats.totalCollections}</div>
              <div class="stat-label">Colecciones</div>
            </div>
            <div class="stat-card">
              <div class="stat-value">{nftStats.totalEditions}</div>
              <div class="stat-label">Total Ediciones</div>
            </div>
            <div class="stat-card">
              <div class="stat-value">{nftStats.soldEditions}</div>
              <div class="stat-label">Vendidas</div>
            </div>
            <div class="stat-card">
              <div class="stat-value">{nftStats.totalRevenue}</div>
              <div class="stat-label">Ingresos</div>
            </div>
          </div>
        </div>
      </section>
    )}

    <!-- Wallet Connection (solo para verificados) -->
    {digitalId.status === 'verified' && (
      <section class="wallet-section">
        <div class="container">
          <div class="wallet-card">
            <div class="wallet-content">
              <h3>🔗 Conectar Wallet</h3>
              <p class="text-muted">Conecta tu wallet para gestionar tus NFTs y transacciones</p>
              <button class="btn btn-accent wallet-connect-btn" id="connect-wallet">
                Conectar Wallet
              </button>
            </div>
          </div>
        </div>
      </section>
    )}

    <!-- Subpages Navigation usando navegación centralizada -->
    {subpages.length > 0 && (
      <section class="subpages-section">
        <div class="container">
          <h2 class="section-title">Más sobre {artistName}</h2>
          <div class="subpages-grid">
            {subpages.map(subpage => (
              <a href={subpage.url} class="subpage-card">
                <h4>{subpage.title}</h4>
                <p class="text-muted">{subpage.description}</p>
              </a>
            ))}
          </div>
        </div>
      </section>
    )}

  </div>
</LayoutBase>

<style>
  /* Estilos específicos del artista usando variables CSS centralizadas */
  .artist-page {
    /* Utiliza clases centralizadas desde artistas.css */
  }
  
  .hero-section {
    padding: var(--spacing-3xl) 0;
    margin-bottom: 3rem;
  }
  
  .hero-content {
    display: flex;
    align-items: center;
    gap: var(--spacing-3xl);
    flex-wrap: wrap;
  }
  
  .artist-image-container {
    position: relative;
    flex-shrink: 0;
  }
  
  .artist-image {
    width: 250px;
    height: 250px;
    border-radius: 50%;
    object-fit: cover;
    border: 4px solid var(--color-primary);
    box-shadow: var(--shadow-xl);
  }
  
  .digital-id-badge {
    position: absolute;
    top: -10px;
    right: -10px;
    padding: var(--spacing-sm) var(--spacing-md);
    border-radius: var(--border-radius-lg);
    font-weight: 600;
    font-size: var(--font-size-sm);
    box-shadow: var(--shadow-md);
  }
  
  .digital-id-badge.verified {
    background: var(--gradient-accent);
    color: white;
  }
  
  .digital-id-badge.pending {
    background: linear-gradient(135deg, var(--color-warning), #fd7e14);
    color: white;
  }
  
  .artist-info {
    flex: 1;
    min-width: 300px;
  }
  
  .artist-name {
    font-size: var(--font-size-4xl);
    font-weight: 700;
    margin-bottom: var(--spacing-lg);
  }
  
  .digital-id-info {
    background: var(--bg-card);
    border-radius: var(--border-radius);
    padding: var(--spacing-lg);
    margin-bottom: var(--spacing-lg);
  }
  
  .info-item {
    display: flex;
    justify-content: space-between;
    margin-bottom: var(--spacing-sm);
  }
  
  .info-item:last-child {
    margin-bottom: 0;
  }
  
  .info-item .label {
    color: var(--text-secondary);
    font-weight: 500;
  }
  
  .info-item .value {
    color: var(--text-primary);
    font-weight: 600;
  }
  
  .pending-info {
    background: rgba(255, 193, 7, 0.1);
    border: 1px solid rgba(255, 193, 7, 0.3);
    border-radius: var(--border-radius);
    padding: var(--spacing-lg);
    margin-bottom: var(--spacing-lg);
  }
  
  .pending-reason {
    color: var(--color-warning);
    font-weight: 600;
    margin-bottom: var(--spacing-sm);
  }
  
  .estimated-date,
  .process-info {
    color: var(--text-secondary);
    margin-bottom: var(--spacing-sm);
  }
  
  .social-section h3 {
    color: var(--color-primary);
    margin-bottom: var(--spacing-md);
  }
  
  .social-links {
    display: flex;
    gap: var(--spacing-md);
    flex-wrap: wrap;
  }
  
  .social-link {
    display: flex;
    align-items: center;
    gap: var(--spacing-xs);
    padding: var(--spacing-sm) var(--spacing-md);
    background: var(--bg-card);
    border: var(--border-width) solid rgba(255, 255, 255, 0.1);
    border-radius: var(--border-radius);
    color: var(--text-secondary);
    text-decoration: none;
    transition: var(--transition-base);
    font-size: var(--font-size-sm);
    font-weight: 500;
  }
  
  .social-link:hover {
    background: var(--bg-overlay);
    transform: translateY(-2px);
  }
  
  .social-link.spotify:hover { color: #1DB954; border-color: #1DB954; }
  .social-link.instagram:hover { color: #E4405F; border-color: #E4405F; }
  .social-link.youtube:hover { color: #FF0000; border-color: #FF0000; }
  .social-link.twitter:hover { color: #1DA1F2; border-color: #1DA1F2; }
  
  .biography-section {
    padding: var(--spacing-3xl) 0;
  }
  
  .biography-content {
    max-width: 800px;
    margin: 0 auto;
  }
  
  .biography-content :global(p) {
    margin-bottom: var(--spacing-lg);
    line-height: 1.8;
    font-size: var(--font-size-lg);
  }
  
  .collections-section,
  .cta-section,
  .stats-section,
  .wallet-section,
  .subpages-section {
    padding: var(--spacing-3xl) 0;
  }
  
  .section-title {
    font-size: var(--font-size-3xl);
    font-weight: 700;
    color: var(--color-primary);
    margin-bottom: var(--spacing-xl);
  }
  
  .album-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
    gap: var(--spacing-xl);
  }
  
  .collection-card {
    background: var(--bg-card);
    border-radius: var(--border-radius-lg);
    overflow: hidden;
    border: var(--border-width) solid rgba(255, 255, 255, 0.1);
    transition: var(--transition-base);
    position: relative;
  }
  
  .collection-card:hover {
    transform: translateY(-5px);
    box-shadow: var(--shadow-xl);
  }
  
  .collection-card.unavailable {
    opacity: 0.7;
  }
  
  .collection-image {
    position: relative;
    height: 250px;
    overflow: hidden;
  }
  
  .collection-image img {
    width: 100%;
    height: 100%;
    object-fit: cover;
  }
  
  .unavailable-overlay {
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: rgba(0, 0, 0, 0.7);
    display: flex;
    align-items: center;
    justify-content: center;
    color: white;
    font-weight: 600;
    font-size: var(--font-size-lg);
  }
  
  .collection-info {
    padding: var(--spacing-xl);
  }
  
  .collection-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    margin-bottom: var(--spacing-md);
    flex-wrap: wrap;
    gap: var(--spacing-sm);
  }
  
  .collection-title {
    color: var(--text-primary);
    font-size: var(--font-size-xl);
    font-weight: 600;
    margin: 0;
  }
  
  .collection-type {
    font-size: var(--font-size-xs);
  }
  
  .collection-description {
    color: var(--text-secondary);
    line-height: 1.6;
    margin-bottom: var(--spacing-lg);
  }
  
  .collection-details {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: var(--spacing-lg);
    flex-wrap: wrap;
    gap: var(--spacing-sm);
  }
  
  .edition-info {
    display: flex;
    align-items: center;
    gap: var(--spacing-xs);
    font-size: var(--font-size-sm);
  }
  
  .edition-info .remaining {
    color: var(--color-primary);
    font-weight: 700;
  }
  
  .edition-info .total,
  .edition-info .label {
    color: var(--text-tertiary);
  }
  
  .collection-price {
    text-align: right;
  }
  
  .price {
    font-size: var(--font-size-xl);
    font-weight: 700;
    color: var(--color-primary);
  }
  
  .cta-card {
    background: var(--bg-overlay);
    border: var(--border-width-md) dashed rgba(123, 63, 228, 0.3);
    border-radius: var(--border-radius-lg);
    padding: var(--spacing-3xl);
    text-align: center;
    transition: var(--transition-base);
  }
  
  .cta-card:hover {
    background: rgba(123, 63, 228, 0.05);
    border-color: rgba(123, 63, 228, 0.5);
    transform: translateY(-3px);
  }
  
  .cta-placeholder-content {
    max-width: 600px;
    margin: 0 auto;
  }
  
  .cta-icon {
    color: var(--color-primary);
    margin-bottom: var(--spacing-lg);
    opacity: 0.8;
  }
  
  .cta-card h3 {
    font-size: var(--font-size-2xl);
    margin-bottom: var(--spacing-md);
  }
  
  .cta-card p {
    color: var(--text-tertiary);
    margin-bottom: var(--spacing-xl);
    font-size: var(--font-size-lg);
  }
  
  .stats-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: var(--spacing-xl);
    max-width: 800px;
    margin: 0 auto;
  }
  
  .stat-card {
    background: var(--bg-card);
    border-radius: var(--border-radius-lg);
    padding: var(--spacing-xl);
    text-align: center;
    border: var(--border-width) solid rgba(255, 255, 255, 0.1);
  }
  
  .stat-value {
    font-size: var(--font-size-3xl);
    font-weight: 700;
    color: var(--color-primary);
    margin-bottom: var(--spacing-sm);
  }
  
  .stat-label {
    color: var(--text-secondary);
    font-size: var(--font-size-sm);
    font-weight: 500;
  }
  
  .wallet-card {
    background: var(--gradient-accent);
    border-radius: var(--border-radius-lg);
    padding: var(--spacing-3xl);
    text-align: center;
    color: white;
    max-width: 600px;
    margin: 0 auto;
  }
  
  .wallet-content h3 {
    font-size: var(--font-size-2xl);
    margin-bottom: var(--spacing-md);
  }
  
  .wallet-content p {
    margin-bottom: var(--spacing-xl);
    opacity: 0.9;
  }
  
  .wallet-connect-btn {
    background: rgba(255, 255, 255, 0.2);
    color: white;
    border: 2px solid rgba(255, 255, 255, 0.3);
    padding: var(--spacing-md) var(--spacing-xl);
    font-size: var(--font-size-lg);
  }
  
  .wallet-connect-btn:hover {
    background: rgba(255, 255, 255, 0.3);
    transform: translateY(-2px);
  }
  
  .subpages-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
    gap: var(--spacing-lg);
  }
  
  .subpage-card {
    background: var(--bg-card);
    border-radius: var(--border-radius);
    padding: var(--spacing-xl);
    text-decoration: none;
    border: var(--border-width) solid rgba(255, 255, 255, 0.1);
    transition: var(--transition-base);
  }
  
  .subpage-card:hover {
    background: var(--bg-overlay);
    border-color: var(--color-primary);
    transform: translateY(-3px);
  }
  
  .subpage-card h4 {
    color: var(--color-primary);
    margin-bottom: var(--spacing-sm);
    font-size: var(--font-size-lg);
  }
  
  .subpage-card p {
    margin: 0;
    line-height: 1.6;
  }
  
  /* Responsive usando breakpoints centralizados */
  @media (max-width: 768px) {
    .hero-content {
      flex-direction: column;
      text-align: center;
      gap: var(--spacing-xl);
    }
    
    .artist-image {
      width: 200px;
      height: 200px;
    }
    
    .artist-name {
      font-size: var(--font-size-3xl);
    }
    
    .album-grid {
      grid-template-columns: 1fr;
    }
    
    .collection-header {
      flex-direction: column;
      align-items: flex-start;
      gap: var(--spacing-sm);
    }
    
    .collection-details {
      flex-direction: column;
      align-items: flex-start;
      gap: var(--spacing-sm);
    }
    
    .cta-card {
      padding: var(--spacing-xl);
    }
    
    .stats-grid {
      grid-template-columns: repeat(2, 1fr);
      gap: var(--spacing-lg);
    }
    
    .wallet-card {
      padding: var(--spacing-xl);
    }
  }
  
  @media (max-width: 480px) {
    .hero-section {
      padding: var(--spacing-2xl) 0;
    }
    
    .artist-image {
      width: 150px;
      height: 150px;
    }
    
    .artist-name {
      font-size: var(--font-size-2xl);
    }
    
    .social-links {
      justify-content: center;
    }
    
    .stats-grid {
      grid-template-columns: 1fr;
    }
    
    .subpages-grid {
      grid-template-columns: 1fr;
    }
  }
</style>

<script>
  // Scripts específicos del artista
  document.addEventListener('DOMContentLoaded', function() {
    // Wallet connection
    const walletBtn = document.getElementById('connect-wallet');
    if (walletBtn) {
      walletBtn.addEventListener('click', function() {
        console.log('Conectar wallet clicked');
        alert('Función de conectar wallet próximamente');
      });
    }
    
    // Acquire NFT buttons
    document.querySelectorAll('.acquire-btn').forEach(btn => {
      btn.addEventListener('click', function() {
        const collectionTitle = this.closest('.collection-card').querySelector('.collection-title').textContent;
        alert(`Próximamente podrás adquirir: ${collectionTitle}`);
      });
    });
  });
</script>